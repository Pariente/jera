<!DOCTYPE html>
<html>
<head>
  <title>
    <% if content_for?(:title) %>
      <%= yield(:title) %>
    <% else %>
      Jera
    <% end %>
  </title>
  <%= stylesheet_link_tag 'application', media: 'all', 'data-turbolinks-track' => true %>
  <%= favicon_link_tag 'favicons/favicon.ico' %>
  <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
  <link rel="apple-touch-icon" sizes="57x57" href="images/apple-touch-icon-57x57.png" />
  <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png" />
  <link rel="apple-touch-icon" sizes="76x76" href="images/apple-touch-icon-76x76.png" />
  <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png" />
  <link rel="apple-touch-icon" sizes="120x120" href="images/apple-touch-icon-120x120.png" />
  <link rel="apple-touch-icon" sizes="144x144" href="images/apple-touch-icon-144x144.png" />
  <link rel="apple-touch-icon" sizes="152x152" href="images/apple-touch-icon-152x152.png" />
  <link rel="apple-touch-icon" sizes="180x180" href="images/apple-touch-icon-180x180.png" />
  <%= javascript_include_tag 'application', 'data-turbolinks-track' => true %>
  <%= csrf_meta_tags %>
  <meta property="og:title" content="Jera - Staying Focused">
  <meta property="og:url" content="http://www.jerapp.com/">
  <meta property="og:description" content="Your time is your most precious treasure. Keep learning and growing in an environment that respects you.">
  <meta property="og:image" content="http://www.jerapp.com/images/jera_facebook_og_image.png">
  <meta property="og:locale" content="en_US">
  <meta property="fb:admins" content="658929354279853">
  <meta name="twitter:site" content="@jerapptree" />
  <meta name="twitter:creator" content="@thpariente" />
  <meta name="viewport" content="initial-scale=1, maximum-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-91476849-1', 'auto');
    ga('send', 'pageview');
  </script>
</head>
<body>
  <%= yield %>
  <script>
    // MASK
    $(".mask").unbind('click').bind('click', function(evt) {
      $(this).parents('.content').find('.content-left-column').addClass('hidden');
      $(this).parents('.content').find('.content-right-column').addClass('hidden');
      $(this).parents('.content').find('.content-masked').removeClass('hidden');
    });
    $(".unmask").unbind('click').bind('click', function(evt) {
      $(this).parents('.content').find('.content-left-column').removeClass('hidden');
      $(this).parents('.content').find('.content-right-column').removeClass('hidden');
      $(this).parents('.content-masked').addClass('hidden');
    });

    // HARVEST
    $(".harvest").unbind('click').bind('click', function(evt) {
      $(this).parents('.content').find('.content-left-column').addClass('hidden');
      $(this).parents('.content').find('.content-right-column').addClass('hidden');
      $(this).parents('.content').find('.content-harvested').removeClass('hidden');
      if (parseInt($('.harvest-count').html(), 10) == 0) {
        if ($(window).width() < 450) {
          $('.go-to-harvest').animate({ bottom: "+=60px" }, 1000 );
        } else {
          $('.go-to-harvest').animate({ bottom: "+=80px" }, 1000 );
        }
      }
      $('.harvest-count').html(parseInt($('.harvest-count').html(), 10)+1)
    });

    $(".cancel-harvest").unbind('click').bind('click', function(evt) {
      $(this).parents('.content').find('.content-left-column').removeClass('hidden');
      $(this).parents('.content').find('.content-right-column').removeClass('hidden');
      $(this).parents('.content').find('.content-harvested').addClass('hidden');
      $('.harvest-count').html(parseInt($('.harvest-count').html(), 10)-1)
      if (parseInt($('.harvest-count').html(), 10) == 0) {
        if ($(window).width() < 450) {
          $('.go-to-harvest').animate({ bottom: "-=60px" }, 1000 );
        } else {
          $('.go-to-harvest').animate({ bottom: "-=80px" }, 1000 );
        }
      }
    });

    // UNHARVEST
    $(".unharvest").unbind('click').bind('click', function(evt) {
      $(this).parents('.content').addClass('hidden');
    });

    // READ
    $(".content-read").unbind('click').bind('click', function() {
      var id = $(this).data("entry");
      $.post("/entries/" + id + "/read", { _method: 'get' });
      if ( $(this).find('.read-sign').hasClass('hidden') ) {
        $(this).find('.read-sign').removeClass('hidden');
        $(this).find('img').addClass('low-opacity');
      }
    });

    $(".read").unbind('click').bind('click', function() {
      $(this).parents('.content-box').find('.read-sign').removeClass('hidden');
      $(this).parents('.content-box').find('img').addClass('low-opacity');
      $(this).siblings('.unread').removeClass('hidden');
      $(this).addClass('hidden');
    });

    // UNREAD

    $(".unread").unbind('click').bind('click', function() {
      $(this).parents('.content-box').find('.read-sign').addClass('hidden');
      $(this).parents('.content-box').find('img').removeClass('low-opacity');
      $(this).siblings('.read').removeClass('hidden');
      $(this).addClass('hidden');
    });

    // SUBSCRIBE

    $(".subscribe-button").unbind('click').bind('click', function(evt) {
      $(this).find('.white-plus').addClass('hidden');
      $(this).find('.red-cross').removeClass('hidden');
      $(this).addClass('unsubscribe-button');
      $(this).removeClass('subscribe-button');
    });

    $(".unsubscribe-button").unbind('click').bind('click', function(evt) {
      $(this).find('.red-cross').addClass('hidden');
      $(this).find('.white-plus').removeClass('hidden');
      $(this).addClass('subscribe-button');
      $(this).removeClass('unsubscribe-button');
    });

  </script>
</body>
</html>